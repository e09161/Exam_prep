<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Writing Practice: Characteristics for Success</title>
  <style>
    * {
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      line-height: 1.6;
      padding: 15px;
      margin: 0;
      background-color: #f5f7fa;
      color: #333;
    }
    
    .container {
      max-width: 900px;
      margin: 0 auto;
    }
    
    h2 {
      color: #2a2a2a;
      border-bottom: 3px solid #28a745;
      padding-bottom: 12px;
      margin: 0 0 15px 0;
      font-size: 1.5rem;
      line-height: 1.3;
    }
    
    .writing-container {
      margin-top: 20px;
      background-color: white;
      padding: 25px 20px;
      border-radius: 12px;
      border: 1px solid #e1e5e9;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    
    .gap {
      position: relative;
      border-bottom: 2px solid #28a745;
      cursor: pointer;
      color: transparent;
      text-shadow: 0 0 3px rgba(0,0,0,0.1);
      transition: all 0.2s ease;
      padding: 0 2px;
      border-radius: 2px;
      font-weight: 600;
    }
    
    .gap:hover, .gap.touch-active {
      color: #2a2a2a;
      text-shadow: none;
      background-color: #e8f5e9;
      border-bottom-color: #4caf50;
    }
    
    .gap::after {
      content: attr(data-word);
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      background: #2a2a2a;
      color: white;
      padding: 8px 12px;
      border-radius: 6px;
      white-space: nowrap;
      font-size: 14px;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease, transform 0.2s ease;
      z-index: 100;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      min-width: 60px;
      text-align: center;
      font-weight: normal;
    }
    
    .gap:hover::after, .gap.touch-active::after {
      opacity: 1;
      transform: translateX(-50%) translateY(-5px);
    }
    
    .gap.active::after {
      opacity: 1 !important;
    }
    
    button {
      display: block;
      width: 100%;
      max-width: 250px;
      margin: 25px auto 10px;
      padding: 14px 20px;
      font-size: 16px;
      font-weight: 600;
      background-color: #28a745;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
      text-align: center;
      touch-action: manipulation;
    }
    
    button:hover, button:active {
      background-color: #218838;
      transform: translateY(-1px);
    }
    
    .instructions {
      background-color: #e8f5e9;
      padding: 16px;
      border-radius: 10px;
      margin-bottom: 20px;
      border-left: 4px solid #28a745;
      font-size: 14px;
      line-height: 1.5;
    }
    
    .mobile-instructions {
      display: none;
      background-color: #fff8e1;
      padding: 12px;
      border-radius: 8px;
      margin: 15px 0;
      border-left: 4px solid #ff9800;
      font-size: 13px;
    }
    
    .practice-options {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin: 20px 0;
      justify-content: center;
    }
    
    .practice-btn {
      padding: 10px 15px;
      background-color: #6c757d;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      transition: background-color 0.3s;
      flex: 1;
      min-width: 120px;
      max-width: 200px;
    }
    
    .practice-btn:hover {
      background-color: #5a6268;
    }
    
    .practice-btn.active {
      background-color: #28a745;
    }
    
    .writing-content p {
      margin: 0 0 20px 0;
      font-size: 16px;
      line-height: 1.7;
      word-wrap: break-word;
      text-align: justify;
    }
    
    .writing-content p:last-child {
      margin-bottom: 0;
    }
    
    .word-count {
      text-align: center;
      margin-top: 10px;
      color: #6c757d;
      font-size: 14px;
    }
    
    .highlight {
      background-color: #fff3cd;
      padding: 2px 4px;
      border-radius: 3px;
    }
    
    /* Mobile-specific optimizations */
    @media (max-width: 768px) {
      body {
        padding: 12px;
      }
      
      h2 {
        font-size: 1.3rem;
        padding-bottom: 10px;
      }
      
      .writing-container {
        padding: 15px 12px;
      }
      
      .writing-content p {
        font-size: 15px;
        line-height: 1.6;
      }
      
      .gap {
        padding: 0 1px;
        border-bottom-width: 2px;
      }
      
      .gap::after {
        font-size: 13px;
        padding: 6px 10px;
        white-space: normal;
        max-width: 150px;
        word-break: break-word;
      }
      
      .mobile-instructions {
        display: block;
      }
      
      button {
        padding: 12px 16px;
        font-size: 15px;
        max-width: 200px;
      }
      
      .instructions {
        padding: 14px;
        font-size: 13px;
      }
      
      .practice-btn {
        padding: 8px 12px;
        font-size: 13px;
        min-width: 100px;
      }
    }
    
    @media (max-width: 480px) {
      .writing-content p {
        font-size: 14px;
        line-height: 1.5;
      }
      
      h2 {
        font-size: 1.2rem;
      }
      
      .container {
        padding: 0 8px;
      }
      
      .gap::after {
        font-size: 12px;
        padding: 5px 8px;
        max-width: 120px;
      }
      
      button {
        max-width: 180px;
        padding: 12px 14px;
        font-size: 14px;
      }
      
      .practice-btn {
        min-width: 80px;
        font-size: 12px;
        padding: 6px 10px;
      }
    }
    
    /* Touch-friendly improvements */
    .gap {
      min-height: 24px;
      display: inline-block;
      vertical-align: middle;
    }
    
    button, .practice-btn {
      min-height: 50px;
    }
    
    /* Improve readability on small screens */
    @media (max-width: 360px) {
      .writing-content p {
        font-size: 13px;
        line-height: 1.4;
      }
      
      .gap::after {
        font-size: 11px;
        padding: 4px 6px;
        max-width: 100px;
      }
      
      h2 {
        font-size: 1.1rem;
      }
    }
    
    /* Dark mode support */
    @media (prefers-color-scheme: dark) {
      body {
        background-color: #1a1a1a;
        color: #e0e0e0;
      }
      
      .writing-container {
        background-color: #2d2d2d;
        border-color: #404040;
      }
      
      .instructions, .mobile-instructions {
        background-color: #1e3521;
        border-left-color: #28a745;
      }
      
      .mobile-instructions {
        background-color: #3a2d1a;
        border-left-color: #ff9800;
      }
      
      .gap:hover, .gap.touch-active {
        background-color: #1e3521;
        color: #a5d6a7;
      }
      
      .gap::after {
        background: #424242;
        color: #f5f5f5;
        box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      }
      
      .highlight {
        background-color: #5d4037;
        color: #ffcc80;
      }
      
      .practice-btn {
        background-color: #495057;
      }
      
      .practice-btn:hover {
        background-color: #3d4348;
      }
      
      .practice-btn.active {
        background-color: #28a745;
      }
    }
    
    /* Touch device detection */
    @media (hover: none) and (pointer: coarse) {
      .gap::after {
        bottom: auto;
        top: 100%;
        transform: translateX(-50%) translateY(10px);
      }
      
      .gap:hover::after, .gap.touch-active::after {
        transform: translateX(-50%) translateY(5px);
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>‚úçÔ∏è Writing Practice: Characteristics for Success</h2>
    
    <div class="instructions">
      <p><strong>Instructions:</strong> Practice the writing sample by hovering over the blank spaces to reveal key vocabulary. Use the buttons below to focus on different aspects of the essay. Click "üîÑ New Gaps" to generate a new set of hidden words.</p>
    </div>
    
    <div class="mobile-instructions">
      <strong>üì± Mobile Tip:</strong> Tap on any blank space to reveal the hidden word. Tap again or tap elsewhere to hide it.
    </div>

    <div class="practice-options">
      <button class="practice-btn active" onclick="setPracticeMode('vocabulary')">Key Vocabulary</button>
      <button class="practice-btn" onclick="setPracticeMode('connectors')">Connectors</button>
      <button class="practice-btn" onclick="setPracticeMode('adjectives')">Adjectives</button>
      <button class="practice-btn" onclick="setPracticeMode('verbs')">Important Verbs</button>
    </div>

    <div class="writing-container">
      <h3>Writing Sample: Essay on Success</h3>
      <div id="writing" class="writing-content"></div>
      <div class="word-count" id="wordCount">Total words: 0 | Hidden words: 0</div>
      <button onclick="generateGaps()">üîÑ New Gaps</button>
    </div>
  </div>

  <script>
    const originalText = `In my view, the most important characteristics for success are resilience and versatility.

First, resilience is key because the path to success is never smooth. You will face failures. A resilient person, like my father when his first business failed, learns from those mistakes and tries again with better knowledge. This ability to adapt and persist is fundamental.

Second, versatility is increasingly vital. The modern workplace changes fast. A versatile person who can handle different tasks‚Äîfrom physical work to office jobs‚Äîis incredibly valuable. They can seize new opportunities and aren't limited to one role.

Together, resilience helps you overcome obstacles, and versatility helps you navigate a changing world, making them a powerful combination for long-term success.`;

    let isTouchDevice = false;
    let currentMode = 'vocabulary';
    
    // Word categories for different practice modes
    const wordCategories = {
      vocabulary: [
        'resilience', 'versatility', 'characteristics', 'success', 
        'fundamental', 'vital', 'valuable', 'opportunities', 
        'obstacles', 'combination', 'adapt', 'persist', 
        'overcome', 'navigate', 'seize', 'limited'
      ],
      connectors: [
        'First', 'Second', 'Together', 'because', 'when', 
        'and', 'who', 'They', 'making', 'from', 'to'
      ],
      adjectives: [
        'important', 'smooth', 'resilient', 'better', 
        'fundamental', 'vital', 'modern', 'versatile', 
        'different', 'physical', 'incredibly', 'valuable', 
        'new', 'powerful', 'long-term'
      ],
      verbs: [
        'face', 'learns', 'tries', 'adapt', 'persist', 
        'changes', 'handle', 'seize', 'helps', 'overcome', 
        'navigate', 'making', 'failed', 'limited'
      ]
    };
    
    // Detect touch device
    function detectTouchDevice() {
      return (('ontouchstart' in window) ||
             (navigator.maxTouchPoints > 0) ||
             (navigator.msMaxTouchPoints > 0));
    }
    
    function setPracticeMode(mode) {
      currentMode = mode;
      
      // Update active button
      document.querySelectorAll('.practice-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      
      event.target.classList.add('active');
      
      // Regenerate gaps with new mode
      generateGaps();
    }
    
    function generateGaps() {
      const container = document.getElementById('writing');
      const wordCountElement = document.getElementById('wordCount');
      isTouchDevice = detectTouchDevice();
      
      const paragraphs = originalText.trim().split('\n\n');
      let result = '';
      let totalWords = 0;
      let hiddenWords = 0;
      
      // Get words for current mode
      const targetWords = wordCategories[currentMode];
      
      paragraphs.forEach(paragraph => {
        const words = paragraph.split(' ');
        totalWords += words.length;
        
        // Process each word in the paragraph
        const processedParagraph = words.map((word) => {
          // Clean the word (remove punctuation)
          const cleanWord = word.replace(/[.,!?‚Äî:]/g, '');
          const punctuation = word.match(/[.,!?‚Äî:]+$/);
          
          // Check if this word should be a gap
          const shouldBeGap = targetWords.some(target => 
            target.toLowerCase() === cleanWord.toLowerCase()
          );
          
          if (shouldBeGap) {
            hiddenWords++;
            return `<span class="gap" data-word="${cleanWord}">__________</span>${punctuation ? punctuation[0] : ''}`;
          }
          
          // Highlight transition words in connectors mode
          if (currentMode === 'connectors' && 
              ['First', 'Second', 'Together', 'because', 'when'].some(t => t === cleanWord)) {
            return `<span class="highlight">${word}</span>`;
          }
          
          return word;
        }).join(' ');

        result += `<p>${processedParagraph}</p>`;
      });
      
      container.innerHTML = result;
      wordCountElement.textContent = `Total words: ${totalWords} | Hidden words: ${hiddenWords}`;
      
      // Add touch event listeners for mobile
      const gaps = container.querySelectorAll('.gap');
      
      if (isTouchDevice) {
        gaps.forEach(gap => {
          gap.addEventListener('touchstart', function(e) {
            e.preventDefault();
            this.classList.toggle('touch-active');
            
            // Hide other gaps when one is active
            gaps.forEach(g => {
              if (g !== this) {
                g.classList.remove('touch-active');
              }
            });
          }, {passive: false});
        });
        
        // Hide all gaps when tapping outside
        document.addEventListener('touchstart', function(e) {
          if (!e.target.closest('.gap')) {
            gaps.forEach(gap => {
              gap.classList.remove('touch-active');
            });
          }
        });
      } else {
        // Desktop hover behavior
        gaps.forEach(gap => {
          gap.addEventListener('mouseenter', function() {
            this.classList.add('touch-active');
          });
          
          gap.addEventListener('mouseleave', function() {
            this.classList.remove('touch-active');
          });
        });
      }
    }

    // Initial generation
    generateGaps();
    
    // Prevent double-tap zoom on mobile
    let lastTouchEnd = 0;
    document.addEventListener('touchend', function(event) {
      const now = Date.now();
      if (now - lastTouchEnd <= 300) {
        event.preventDefault();
      }
      lastTouchEnd = now;
    }, false);
    
    // Add touch device class to body for CSS targeting
    if (detectTouchDevice()) {
      document.body.classList.add('touch-device');
    }
  </script>
</body>
</html>
